
/*Gán quyền cho user*/
--  grant execute on sys.dbms_crypto to myuser;

/*Tạo các bảng còn thiếu*/

CREATE TABLE "LOGGER_ERROR_MOBILE" 
   (	"I" NUMBER(19,0) NOT NULL ENABLE PRIMARY KEY, 
	"C" NVARCHAR2(10) NOT NULL ENABLE, 
	"N" NVARCHAR2(50) NOT NULL ENABLE, 
	"DETAIL" NVARCHAR2(1500), 
	"USER_ID" NUMBER(19,0), 
	"USER_INFO" NVARCHAR2(500), 
	"SYSD" DATE DEFAULT SYSDATE ) 
	
CREATE TABLE "SE_NOTIFICATION" 
   (	"ID" NUMBER NOT NULL ENABLE PRIMARY KEY, 
	"NVALUE" NVARCHAR2(20), 
	"SVALUE" NVARCHAR2(20), 
	"MESSAGE" NVARCHAR2(400), 
	"SENT_DATE" DATE, 
	"CREATED_DATE" DATE, 
	"FROM_EMPLOYEE_ID" NUMBER(10,0), 
	"TO_EMPLOYEE_ID" NUMBER(10,0), 
	"CREATED_BY" NVARCHAR2(255), 
	"CREATED_LOG" NVARCHAR2(255), 
	"SEND_STATUS" CHAR(2), 
	"SEND_LOG" NVARCHAR2(255), 
	"SEND_NUMBER" NUMBER);

   COMMENT ON COLUMN  "SE_NOTIFICATION"."MESSAGE" IS 'Noi dung notify';
   COMMENT ON COLUMN "SE_NOTIFICATION"."SENT_DATE" IS 'Thoi gian gui';
   COMMENT ON COLUMN "SE_NOTIFICATION"."CREATED_DATE" IS 'Thoi gian tao';
   COMMENT ON COLUMN "SE_NOTIFICATION"."FROM_EMPLOYEE_ID" IS 'ID nhan vien gui';
   COMMENT ON COLUMN "SE_NOTIFICATION"."TO_EMPLOYEE_ID" IS 'ID nhan vien nhan';
   COMMENT ON COLUMN "SE_NOTIFICATION"."CREATED_BY" IS 'user tao';
   COMMENT ON COLUMN "SE_NOTIFICATION"."CREATED_LOG" IS 'log tạo (may, app tao)';
   COMMENT ON COLUMN "SE_NOTIFICATION"."SEND_STATUS" IS 'tinh trang gui 00: moi tao, 01: send fail, 02: success';
   COMMENT ON COLUMN "SE_NOTIFICATION"."SEND_LOG" IS 'Ghi chu log gui fai,...';
   COMMENT ON COLUMN "SE_NOTIFICATION"."SEND_NUMBER" IS 'So lan gui';
   COMMENT ON TABLE "SE_NOTIFICATION"  IS 'Lưu thông tin các notify message của toàn hệ thống, trạng thái đăng ký thời gian, notify hệ thống';	
	
	-- bảng session info
	CREATE TABLE "SE_USERLOGIN" 
   (	"ID" NUMBER(*,0) NOT NULL ENABLE, 
	"USERID" NUMBER(*,0) NOT NULL ENABLE, 
	"DEVICE_ID" nvarchar2(50),
	"TOKEN" VARCHAR2(255 BYTE), 
	"ACTFLG" VARCHAR2(2),
	 CONSTRAINT "SE_USERLOGIN_PK" PRIMARY KEY ("ID")
  USING INDEX PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1 BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS"  ENABLE
   )


   CREATE SEQUENCE SEQ_SE_USERLOGIN START WITH 1 INCREMENT BY 1;
   -- thêm trường để lưu token gửi notification
   ALTER TABLE SE_USERLOGIN  ADD Firebase_Client_Id nvarchar2(200);


